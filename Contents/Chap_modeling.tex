\chapter{建模}
\label{cha:Modeling}

为了研究所提出的梯级系统的性能，使用EES（Engineering Equation Solver）和MATLAB（Matrix Laboratory）作为计算工具和开发工具开发了系统的机理模型。系统建模采用自底向上的设计方法。首先，在EES中建立机理模型用于来验证模型中各参数间的物理关系。其次，使用面向对象的方法在MATLAB中开发出组件模型，它充分利用了面向对象的继承性和多态性来保证组件之间的独立性和相关性。
依据不同流体，创建了三个回路（空气回路，水回路和油回路），并确定了一些关键部件的特定的状态参数。依据这些关键部件的热力学特性和热力学第二定律，为其创建了基于能量平衡的机理模型。

以下部分介绍一些关键部件的模型。
\section{部件建模}
\subsection{槽式集热器}
\label{sec:ptc}

槽式集热器由反射镜和接收器组成。反射镜（镜面）反射太阳直射辐射并将其会聚到位于抛物槽面焦线处的接收器上。接收器通常包含涂有高吸收率涂层的金属吸热管。在吸热管外部设有玻璃管以减少散热损失，吸热管和玻璃管之间通常被抽成真空以进一步减少热损。

在反射过程中存在着光学损失，主要包含以下几项\cite{Price2002}：

\begin{itemize}
  \item 遮挡损失
  \item 追踪损失
  \item 形状损失
  \item 反射率损失
  \item 镜面沾污损失
  \item 其它未列入损失
\end{itemize}

还有一项，即太阳直射的阳光与集热器开口不垂直时，应该考虑入射角带来的损失$K(\theta)$（也称为余弦损失）。该损失是太阳入射角与集热器开口法线交角（$\theta$）的函数。

桑迪亚国家实验室的Dudley等\cite{Dudley1994}通过试验研究给出了槽式集热器的余弦损失计算公式：
\begin{equation}
  K(\theta) = \cos\theta+0.000884\theta-0.00005369\theta^2
\end{equation}

图\ref{fig:ParabolicTrough}给出了槽式集热器反射太阳光线的示意图，图中还标出了影响光学损失的一些参数。整个光学损失与下列五个参数有关：

\begin{enumerate}[label=(\arabic*)]
  \item 反射率，$\rho$：只有一部分入射辐射会反射到接收器上。这一部分由反射镜的种类决定。对于清洗干净的商业槽式反射镜，其反射率可以假定为0.9。
  \item 拦截因子，$\gamma$：由于反射镜的微观缺陷或抛物面槽式集热器的宏观形状误差，反射镜反射的太阳直射辐射中的一部分不能到达吸热管（例如组装不精确）。这些缺陷或误差导致一些光线以错误的角度反射，因此它们不能被吸热管拦截吸收。这些损失通过称为拦截因子的光学参数来量化。对于正确组装的集热器而言，该参数通常为0.95。
  \item 透射率$\tau$：到达接收器的玻璃管的太阳直射辐射只有一部分能够透射它。透射玻璃管的辐射与投射到其上的总的入射辐射之间的比称为透射率$\tau$，它通常取为0.93。
  \item 吸热管涂层的吸收率，$\alpha_{abs}$：该参数量化了吸热管吸收的能量与到达吸热管外壁的总辐射量的比例。对于有陶瓷涂层的金属吸热管，该参数通常为0.95，而对于涂有黑色镍或铬的吸热管，该参数值稍低。
  \item 沾污因子，$F_e$：反射镜上的污垢会降低反射率，因此需要考虑沾污带来的影响。沾污因子$F_e$的引入考虑了反射镜和玻璃管在清洗干净之后的逐渐产生的沾污。
\end{enumerate}

\begin{figure}[!ht]
\centering
\includegraphics[width=0.4\textwidth]{fig/ParametersOfParabolicDish.pdf}
\caption{槽式集热器结构示意图}\label{fig:ParabolicTrough}
\end{figure}

穿透玻璃管到达吸热器的能量可以表示为
\begin{equation}
  P = I_r w_{tc} L_{tc} \rho \gamma \tau F_e K(\theta)
\end{equation}

为了简化吸热器的吸热过程，通常将其视为均匀的热流量$q''$。

\begin{equation}
  q''= \frac{P}{\pi d_o L_{tc}} = \frac{I_r w_{tc} \rho \gamma \tau F_e K(\theta)}{\pi d_o}
\end{equation}

%LUZ solar collector LS-3 is used as the trough collector.
%%For a trough collector, 
%The heat flux to the outer surface of the receiver can be obtained by $q''=I_rw_{tc}\eta_{opt,0}K(\phi)F_{e}/P$, where $P=\pi{}d_o$, $K(\phi)$ is the incidence angle modifier, $\eta_{opt,0} = \rho \gamma \tau \alpha_{abs}$
%is peak optical efficiency (optical efficiency with an incidence angle of 0).
%\nomenclature{$K$}{Incidence angle modifier of trough collector}
%%\nomenclature[G]{$\eta_{opt,0}$}{Optical efficiency with an incidence angle of 0}

假设整体传热系数$U(T_{abs})$沿着整个集热器的长度方向是均匀的，这样就可以利用附录\ref{cha:CTCHFHX}中的传热计算公式。吸收管的传热分析示意图如图\ref{fig:Pipe}所示。
\nomenclature{$U$}{Overall heat transfer coefficient, W$\cdot$m$^{-2}\cdot$K$^{-1}$}
\nomenclature{$q''$}{Heat flux, W$\cdot$m$^{-2}$}
\begin{equation}
	\frac{T_{o}-T_{amb}-\dfrac{q''}{U(T_{abs})}}{T_{i}-T_{amb}-\dfrac{q''}{U(T_{abs})}}=\exp(-\frac{U(T_{abs})\pi d_o L_{tc}}{\dot{m}c_{p}})\label{eq:CTCHF}
\end{equation}

\begin{figure}[!ht]
\centering
\includegraphics[width=0.6\textwidth]{fig/Pipe.pdf}
\caption{吸热管的传热分析示意图}\label{fig:Pipe}
\end{figure}

由于管道中的努塞尔数$Nu$非常大（大约为$1/times10^4$），吸热管和导热油之间存在很小的温差。所以平均流体温度$(T_{i}+T_{o})/2$可以用作$T_{abs}$的平均值，$U(T_{abs})$可以用Romero和Zarza给出的二阶多项式函数表示\cite{Romero2007}。达到所需加热效果的槽式集热器的长度$L_{tc}$可以从公式（\ref{eq:CTCHF}）中获得。

垂直投射到槽式集热器开口的能量为
\begin{equation}
  Q_{total} = I_r L_{tc} w_{tc}
\end{equation}

被传热流体吸收的能量为
\begin{equation}
  Q_{use} = \dot{m}c_p(T_o - T_i)
\end{equation}

槽式集热器的集热效率为
\begin{equation}
  \eta_{tc} = \dfrac{Q_{use}}{Q_{total}} = 
  \dfrac{I_r L_{tc} w_{tc}}{\dot{m}c_p(T_o - T_i)}
  \label{eq:eta_tc}
\end{equation}

\subsection{碟式集热器}
\label{sec:pdc}

碟式集热器由发射镜和接收器组成。反射镜通过追踪太阳来将太阳光反射并会聚到位于反射镜焦点处的接收器熵。碟式集热器需要采用双轴跟踪系统来不间断地追踪太阳的轨迹。

碟式集热器的追踪系统主要有两种型式：\cite{Adkins1987}
\begin{itemize}
  \item 由方位传感器进行的方位高度角跟踪，或由计算得到的太阳坐标通过控制系统进行控制。
  \item 极轴跟踪，集热器围绕与地轴平行的轴旋转追踪太阳。
\end{itemize}

在传统的碟式斯特林机系统中，斯特林发动机放置在碟式集热器的焦点上。斯特林机设有接收器来吸收会聚的阳光。接收器由一个开孔和一个吸热器组成。斯特林接收器的开孔位于反射器的焦点处，以减少辐射和对流损失。吸热器吸收太阳辐射能并将产生的热能传递给斯特林机的工作气体，为斯特林循环提供热量，使斯特林机的曲轴连续往复运动。直接连接到斯特林机曲轴的发电机将机械能转化为电能。

本文提出的梯级系统中，碟式集热器的焦点处放置有容积式接收器。 一个金属螺旋管（称为吸热管）作为吸热器位于接收器中以吸收集中的太阳能。空气（或氮气）被用作传热流体流经吸热管以传输被吸热管吸收的能量，为斯特林机提供热源。

碟式反射镜是碟式系统的重要元件。弯曲的反射表面可以利用单独的小平面连接起来形成，或是通过由连续气室成形的拉伸膜来实现。在所有的情况下，曲面都应涂铝或银以提高反射率。

本文选用SES（Stirling Energy System）公司生产的碟式反射镜作为梯级集热系统的碟式反射镜，其主要参数见于表\ref{tab:dc}。碟式接收器为自行设计研制的接收器，图\ref{fig:dishReceiver}是其结构示意图。

\begin{figure}[!ht]
\centering
\includegraphics[width=0.4\textwidth]{fig/DishReceiver.pdf}
\caption{碟式接收器的结构示意图}\label{fig:dishReceiver}
\end{figure}

\begin{table}[htbp]
	\caption{碟式集热器的主要参数}
	\begin{center}
	\begin{tabular}{cccccc}
		\toprule
		Parameter		&	Value	&	Parameter		&	Value	&	Parameter		&	Value\\
		\midrule
		$d_{cav}$	&	0.46$\,\mathrm{m}$	&	$\epsilon_{insu}$	&	0.6	&	$\theta_{dc}$	&	45$^\circ$\\
		$\delta_{insu}$	&	0.075$\,\mathrm{m}$	&	$\alpha_{cav}$	&	0.87	&	$\gamma$	&	0.97\\
		$dep_{cav}$	&	0.23$\,\mathrm{m}$	&	$\delta_a$		&	0.005$\,\mathrm{m}$	&	$\eta_{shading}$	&	0.95\\
		$d_{ap}$	&	0.184$\,\mathrm{m}$	&	$d_{i,1}$	&	0.07$\,\mathrm{m}$	&	$\rho$	&	0.91\\
		$\lambda_{insu}$	&	0.06$\,\mathrm{W/(m\cdot K)}$	&	$A_{dc}$	&	87.7$\,\mathrm{m^2}$	&	\\		
		\bottomrule
	\end{tabular}
	\end{center}
	\label{tab:dc}
\end{table}

\nomenclature[G]{$\delta$}{Thickness, m}
\nomenclature[S]{$insu$}{Insulating layer}
\nomenclature{$dep$}{Depth, m}
\nomenclature{$d$}{Diameter, m}
\nomenclature[G]{$\lambda$}{Thermal conductivity, W$\cdot{}$m$^{-1}$$\cdot$K$^{-1}$}
\nomenclature[G]{$\epsilon$}{Emissivity}
\nomenclature[G]{$\theta_{dc}$}{Dish aperture angle (0$^{\circ}$ is horizontal, 90$^{\circ}$ is vertically down)}
\nomenclature[G]{$\gamma$}{Intercept factor; compression ratio}
\nomenclature[G]{$\eta_{shading}$}{Shading factor}
\nomenclature[G]{$\rho$}{Reflectivity}
\nomenclature{$A_{se,1}$}{Heat transfer area of Stirling engine at air side, m$^2$}
\nomenclature{$A_{se,2}$}{Heat transfer area of Stirling engine at water side, m$^2$}
\nomenclature{$n_g$}{Amount of working gas in each Stirling engine, mol}
\nomenclature{$n_{se}$}{Number of Stirling engines in the Stirling engine array}

碟形接收器模型涉及的损失包括：接收器拦截损失，由于阴影造成的损失以及热损失。热损失占所有这些损失的最大部分，这部分损失由传导，对流和辐射三种形式组成。
\noindent \begin{figure}[ht!]
\begin{center}
	\includegraphics[width = 0.5\columnwidth]{fig/thermalLosses.pdf}
	\caption{碟式接收器的热网络模型}
	\label{fig:thermal-lose}
\end{center}
\end{figure}
为了详细分析碟式接收器的热损失，建立了如图\ref{fig:thermal-lose}所示的热网络模型。该网络模型考虑了以下损失：
\begin{itemize}
	\item 由接收器孔腔从接收器开口反射出去的辐射能损失，$q_{rad,ref}$。
	\item 由于和接收器的绝热层发生热传导产生的损失，$q_{cond,tot}$。
	\item 无风的条件下接收器开口处发生的自然对流损失，$q_{conv,free}$。
	\item 有风的条件下接收器开口处发生的强制对流损失，$q_{conv,forc}$。
	\item 由接收器孔腔发射出去的热辐射造成的辐射损失，$q_{rad,emit}$。
\end{itemize}

为了求解图\ref{fig:thermal-lose}中的热网络结构图，必须仔细分析图中各热流量的关系和求解方程。

\begin{enumerate}[label=(\arabic*)]
  \item \emph{入射到接收器的能量, $q_i$}
  
  为了简化模型，不考虑接收器对反射镜造成的遮挡，以及太阳跟踪系统的调节滞后造成的不利影响。
  \begin{equation}
      q_i = I_r A_{dc} \gamma \eta_{shading} \rho
      \label{eq:q_i}
  \end{equation}
  In Equation~(\ref{eq:q_i}), $\gamma$ is the intercept factor, $\eta_{shading}$ is the shading factor between different collectors, $\rho$ is the reflectivity of the reflector.
  在方程(\ref{eq:q_i})中，$\gamma$是拦截因子，$\eta_{shading}$是不同集热器之间遮挡造成的遮挡因子，$\rho$是反射镜的反射率。
  \item \emph{传热流体与吸热管之间的换热，$q_{dr,1}$}
  
  传热流体于吸热管之间的换热简化为经典的流体流过等壁温管道的换热模型。这样，$q_{dr,1}$可以由下式得到
  \begin{equation}
      q_{dr,1} = h_{dr,1}A_{dr,1}\Delta T_{ln,dr,1}
      \label{eq:q_dr_1}
  \end{equation}
  \nomenclature{$A_{dr,1}$}{Heat transfer area of dish receiver between tube and air, $\mathrm{m^2}$}  
  where  
  \begin{equation}
      h_{dr,1} = Nu_{tube}\lambda_{dr,1} / d_{i,1}
\end{equation}
\begin{equation}
      Nu_{tube} = c_r Nu'_{tube}
\end{equation}
    \nomenclature{$Nu$}{Nusselt number}
    \nomenclature{$c_r$}{Heat transfer correction factor of coiled tube of volumetric receiver}
    该式为修正后应用于螺旋管的努赛尔数计算公式，式中存在基于弯管曲率的螺旋因子$c_r$作为修正系数。$c_r$的表达式为：\cite{Pablo2008}
\begin{equation}
	c_{r}=1+3.5\frac{d_{i,1}}{d_{cav}-d_{i,1}-2\delta_{a}}
\end{equation}
$Nu'_{tube}$是直圆管的努赛尔数，它由下式计算：\cite{Serth2007}
\begin{equation}
	Nu'_{tube}= 0.027Re_{tube}^{0.8}Pr_{tube}^{1/3}(\mu_{tube}/\mu_{tube,w})^{0.14}
\end{equation}
\nomenclature{$Pr$}{Prandtl number}
\nomenclature{$Re$}{Reynolds number}
\nomenclature[G]{$\mu$}{Viscosity, kg$\cdot$m$^{-1}$$\cdot$s$^{-1}$}
\nomenclature[S]{$w$}{Tube wall}
传热流体与管壁之间的对数温差$\Delta{}T_{ln,dr,1}$可以写作
\begin{equation}
	\Delta{}T_{ln,dr,1}=\frac{(T_{cav}-T_{dc,i})-(T_{cav}-T_{dc,o})}{\ln\dfrac{T_{cav}-T_{dc,i}}{T_{cav}-T_{dc,o}}}
\end{equation}

  \item \emph{由接收器内壁从接收器开口反射出去的辐射能损失, $q_{rad,ref}$}
  \begin{equation}
    q_{rad,ref}=(1-\alpha_{eff})q_{i}
\end{equation}
    其中，$\alpha_{eff}$是接收器的等效吸收率，它由下式算得：
    \begin{equation}
    \alpha_{eff}=\frac{\alpha_{cav}}{\alpha_{cav}+(1-\alpha_{cav})\dfrac{A_{ap}}{A_{cav}}}
    \end{equation}
    
    $\alpha_{cav}$是接收器孔腔材料的吸收率，$A_{cav}$是孔腔的总面积，$A_{ap}$是开口面积.
  \item \emph{由于和接收器的绝热层发生热传导产生的损失, $q_{cond,tot}$}
  
  \begin{equation}
q_{cond,tot}=2\pi\lambda_{insu}dep_{cav}\dfrac{T_{cav}-T_{insu}}{\ln(1 + 2\delta_{insu}/d_{cav})}
    \end{equation}
    
    其中，$T_{cav}$是孔腔的壁温，$T_{insu}$ is outside temperature of the insulation wall.

  \item \emph{Convection losses from the receiver insulating layer, $q_{cond,conv}$}  
  \begin{equation}
%\begin{split}
	q_{cond,conv}=h_{insu}A_{insu}(T_{insu}-T_{amb})
	=\dfrac{k_{insu}Nu_{insu}A_{insu}(T_{insu}-T_{amb})}{d_{cav}+2\delta_{insu}}
%\end{split}
\end{equation}
%\nomenclature{$k_{insu}$}{Thermal conductivity of air at the temperature of outside insulating layer, W$\cdot$m$^{-1}\cdot$K$^{-1}$}
where $Nu_{insu}$ can be obtained from the correlation for flow over a circular cylinder.~\cite{Churchill1977}

  \item \emph{Radiation losses from the receiver insulating layer, $q_{cond,rad}$}  
  \begin{equation}
	q_{cond,rad}=\epsilon_{insu}A_{insu}\sigma(T_{insu}^4 - T_{amb}^4)
\end{equation}
  \item \emph{Free convection from the cavity in the absence of wind, $q_{conv,free}$}
    
  Ma~\cite{Ma1993} conducted tests to determine the free convection losses from the receiver for alternative setups, and the data were consistent with Stine and McDonald's free convection correlation. It is assumed that forced convection is independent of free convection in the receiver, so the total convection losses can be represented as the total of the free and forced convection losses as shown in Figure~\ref{fig:thermal-lose}.  
  \begin{equation}
	q_{conv,free} = h_{free}A_{cav}(T_{cav}-T_{amb})
\end{equation}
where $h_{free}=k_{film}Nu_{free}/\overline{d_{cav}}$, $\overline{d_{cav}}$ is the effective diameter of the cavity, $\overline{d_{cav}}=d_{cav}-2d_i-4 \delta_a$.
\nomenclature{$\overline{d_{cav}}$}{Effective diameter of the cavity, m}
\nomenclature{$d_i$}{Inner diameter of trough receiver, m}$d_{i}=$0.066$\,$m
  
  \item \emph{Force convection from the cavity in the presence of wind, $q_{conv,forc}$}  
  \begin{equation}
	q_{conv,forc} = h_{forc}A_{cav}(T_{cav}-T_{amb})
\end{equation}

    Wu et al.~\cite{Wu2010} present a comprehensive review and systematic summarization of convection heat loss from cavity receiver in parabolic dish solar thermal power system. And we choose the correlation presented by Leibfried and Ortjohann~\cite{Leibfried1995}. This correlation gives an extended model of Koenig and Marvin~\cite{Koenig1981} and Stine and Diver~\cite{Stine1994} with better results.

For forced convection loss, side-on wind convection loss model given by Ma~\cite{Ma1993}, which is independent of the aperture orientation, is used
\begin{equation}
	h_{forc}=0.1967v_{wind}^{1.849}
\end{equation}

  \item \emph{Emission losses due to thermal radiation emitted from the receiver aperture, $q_{rad,emit}$}
  
  The emissivity is set equal to the effective absorptivity of the cavity (gray body),
\begin{equation}
    \epsilon_{cav}=\alpha_{eff}
\end{equation}
\begin{equation}
    q_{rad,emit}=\epsilon_{cav}A_{ap}\sigma(T_{cav}^{4}-T_{amb}^{4})
\end{equation}
\end{enumerate}

From Figure~\ref{fig:thermal-lose}, it can be found that

\begin{equation}
  q_{eff} = q_i - q_{rad,ref}
\end{equation}
\begin{equation}
  q_{eff} = q_{dr,1} + q_{cond,tot} + q_{conv,free} + q_{conv,forc}+q_{rad,emit}
\end{equation}
\begin{equation}
  q_{cond,tot} = q_{cond,conv}+q_{cond,rad}
\end{equation}

So the temperature nodes in the thermal network can be solved by these equations.

$q_{dr,1}$ can be obtained from Equation~(\ref{eq:q_dr_1}), and efficiency of the dish receiver
\begin{equation}
  \eta_{dr} = \frac{q_{dr,1}}{q_i}
\end{equation}

Efficiency of the dish collector
\begin{equation}
  \eta_{dc} = \frac{q_{dr,1}}{I_rA_{dc}}
\end{equation}

\subsection{Stirling engine}\label{sec:StirlingEngineModel}
\subsubsection{Theoretical Stirling cycle}
In a Stirling cycle, there are two isothermal processes that exchange heat with heating and cooling fluids, two isochoric processes that exchange heat with regenerator. Figure~\ref{fig:StirlingCycle} shows the $T$-$s$ diagram of a typical Stirling cycle. The heat absorbed by regenerator in process 4-1 is reused in process 2-3, but only able to heat the working gas from 2 to 3' due to the imperfect regeneration. $e$ is defined as the regenerator effectiveness\cite{Formosa2010,Juhasz2010}, $e=\dfrac{T_R-T_L}{T_H-T_L}$, where $T_H$ is the temperature in the hot space, $T_L$ is the temperature in the cold space, $T_R$ is the effective working fluid temperature in the regenerator.
\nomenclature{$e$}{Regenerator effectiveness}
\nomenclature{$T_R$}{Effective working fluid temperature in regenerator, K}
\nomenclature{$T_L$}{Working fluid temperature in the cold space, K}
\nomenclature{$T_H$}{Working fluid temperature in the hot space, K}

\noindent \begin{figure}[htbp]
\begin{center}
	\includegraphics[width = 0.4\columnwidth]{fig/StirlingCycle}
	\caption{$T$-$s$ diagram of a Stirling cycle}
	\label{fig:StirlingCycle}
\end{center}
\end{figure}

In order to obtain a simplified analytical model, several simplifications are made:

\begin{itemize}
\item The working gas in Stirling engines obeys the idea gas law.
\item No heat loss to the environment for Stirling engines.
\item Overall heat transfer coefficients of the fluids are constant.
\item A symmetrical regenerator behavior is assumed so that a simple effectiveness can be obtain by $T_{R}=\dfrac{T_{H}-T_{L}}{\ln(T_{H}/T_{L})}$.~\cite{Formosa2010,Juhasz2010}
\end{itemize}

To consider internal irreversibilities in a Stirling cycle made by dead volumes, total dead volume $V_D$ can be divided into heater dead volume $V_{DH}$, regenerator dead volume $V_{DR}$ and cooler dead volume $V_{DC}$.~\cite{Duan2014}, There exists a factor $K$ to describe the dead volumes under different temperatures. $K$ is relevant with temperatures in the process and regenerator effectiveness.
\nomenclature{$V_D$}{Total dead volume, m$^3$}
\nomenclature{$V_{DH}$}{Hot space dead volume, m$^3$}
\nomenclature{$V_{DR}$}{Regenerator dead volume, m$^3$}
\nomenclature{$V_{DC}$}{Cold space dead volume, m$^3$}
\begin{equation}
	K = \frac{V_{DH}}{T_H} + \frac{V_{DR}}{T_R} + \frac{V_{DC}}{T_L}
\end{equation}
\nomenclature{$K$}{Dead volume factor}

For the isothermal compression process 1-2, the output work
\begin{equation}
	W_{12} = \int^{V_E}_{V_E+V_C}{p_{12}dV}=-mRT_L\ln{\frac{V_E+V_C+KT_L}{V_E+KT_L}}
\end{equation}
%\nomenclature{$W_{12}$}{Output work in process 1-2 (J)}
\nomenclature{$V_E$}{Expansion volume, m$^3$}
\nomenclature{$V_C$}{Compression volume, m$^3$}
\nomenclature{$m$}{Mass of working fluid in Stirling engine, kg}
\nomenclature{$R$}{Gas constant, J$\cdot$kg$^{-1}\cdot$K$^{-1}$}

For the isothermal expansion process 3-4, the output work
\begin{equation}
	W_{34} = \int^{V_E+V_C}_{V_E}{p_{34}dV}=mRT_H\ln{\frac{V_E+V_C+KT_H}{V_E+KT_H}}
\end{equation}
%\nomenclature{$W_{34}$}{Output work in process 3-4 (J)}

Define $\gamma_H = \dfrac{V_E+V_C+KT_H}{V_E+KT_H}$, and $\gamma_L = \dfrac{V_E+V_C+KT_L}{V_E+KT_L}$. In a cycle, the theoretical output work
\nomenclature[G]{$\gamma_H$}{Space ratio in process 12}
\nomenclature[G]{$\gamma_L$}{Space ratio in process 34}
\begin{equation}
	W_{th} = W_{12} + W_{34} = mR(T_H\ln\gamma_H - T_L\ln\gamma_L)
\end{equation}
\nomenclature{$W$}{Output work, J}
\nomenclature[S]{$th$}{Theoretical}

For the isochoric heating process 3'-3, the absorbed heat
\begin{equation}
	\begin{split}
		Q_{3^{'}3} = nc_v(T_H-T_R)
%		\\=n(1-e)c_v(T_H-T_L)
		=\frac{1-e}{k-1}mR(T_H-T_L)
	\end{split}
\end{equation}

%\nomenclature{$Q_{3^{'}3}$}{heat absorbed in process $3^{'}3$ (J)}
%\nomenclature{$M$}{Mole mass of the working fluid in Stirling engine, kg$\cdot$mol$^{-1}$)}
\nomenclature{$c_v$}{Specific heat at constant volume, J$\cdot$kg$^{-1}\cdot$K$^{-1}$}
\nomenclature{$k$}{Specific heat ratio ($c_p/c_v$), thermal conductivity, W$\cdot$m$^{-1}\cdot$K$^{-1}$}

For the the isothermal expansion process 3-4, the absorbed heat
\begin{equation}
	Q_{34} = W_{34} = mRT_H\ln\gamma_H
\end{equation}
%\nomenclature{$Q_{34}$}{heat absorbed in process 3-4 (J)}

In a cycle, the theoretical absorbed heat
\begin{equation}
	Q_{th} = Q_{3^{'}3} + Q_{34} = \frac{1-e}{k-1}mR(T_H-T_L) + mRT_H\ln\gamma_H
\end{equation}
\nomenclature{$Q$}{Absorbed heat, J}

%The Stirling cycle efficiency

%\begin{equation}
%	\eta = \frac{W}{Q} = \frac{T_H\ln\gamma_H - T_L\ln\gamma_L}{T_H\ln\gamma_H + \frac{1-e}{k-1}(T_H-T_L)}
%	\label{Eq:eta}
%\end{equation}
%\nomenclature[G]{$\eta$}{efficiency of a Stirling engine}
%
%and the output power
%
%\begin{equation}
%	P = {W}s_{se} = mRs_{se}(T_H\ln\gamma_H - T_L\ln\gamma_L)
%	\label{Eq:P}
%\end{equation}
\nomenclature{$P$}{Power of Stirling engine, W}
\nomenclature{$s_{se}$}{Speed of Stirling engine, Hz}

%In order to describe quantitatively the effect of the internal dissipation of the working fluid on the performance (efficiency and power) of Stirling engine, the cycle irreversibility parameter, $R_S$, is defined as~\cite{Kaushik2003}:
%\nomenclature{$R_S$}{cycle irreversibility parameter}
%
%\begin{equation}
%	R_S = \frac{\ln\gamma_H}{\ln\gamma_L} = \frac{s_4 - s_3}{s_1 - s_2}
%\end{equation}
%\nomenclature{$s$}{specific entropy (J$\cdot$kg$^{-1}\cdot$K$^{-1}$)}
%
%If the internal processes are reversible, $R_S = 1$, Equation~\ref{Eq:eta} becomes the same as described in~\cite{Stine1994}:
%
%\begin{equation}
%	\eta = \frac{T_H - T_L}{T_H + \frac{1-e}{k-1}\cdot\frac{T_H-T_L}{\ln\gamma}}
%\end{equation}
%\nomenclature[G]{$\gamma$}{compression ratio}

%It can be found from Equation~\ref{Eq:eta} and~\ref{Eq:P} that
%given the properties of a Stirling engine, its efficiency and power can be obtained by known $T_H$ and $T_L$.

\subsubsection{Irrevisibilities and losses}

\begin{enumerate}[label=(\arabic*)]
\item Non-ideal heat transfer effect

Because of non-ideal heater and cooler, the working fluid temperature ($T_{H}$/$T_L$) in these two heat exchangers is less/higher than the wall temperature ($T_{hw}$/$T_{cw}$), respectively. $T_{H}$ and $T_{L}$ can be corrected by the wall temperatures as follows:
\begin{equation}
	T_H = T_{hw} - \frac{Qs_{se}}{h_hA_{hw}}
	\label{eq:T_H}
\end{equation}
\nomenclature[S]{$hw$}{Heater wall}
\begin{equation}
	T_L = T_{cw} + \frac{(Q-W)s_{se}}{h_cA_{cw}}
	\label{eq:T_L}
\end{equation}
\nomenclature[S]{$cw$}{Cooler wall}

The heat transfer coefficient can be obtained using the following correlation~\cite{Babaelahi2015}:
\begin{equation}
	h_{h,c} = \frac{\mu c_pf_{Re}}{2D_{h,c}Pr_{h,c}}
\end{equation}

where $f_{Re}$ is a Reynolds friction factor defined as:
\begin{equation}
	f_{Re} = 0.0791Re_{h,c}^{0.75}
\end{equation}

$Re_{h,c}$, $Pr_{h,c}$ and $D_{h,c}$ are Reynolds number, Prandtl number and hydraulic diameter of the heater/cooler exchanger.

\item Effect of pressure drop

Pressure drops in the heat exchangers cause power losses of the Stirling engine. The pressure drops can be expressed by:~\cite{Urieli1984}
\begin{equation}
	\Delta p = -\frac{2f_{Re}\mu u V}{d^2A}
\end{equation}
\nomenclature{$p$}{Pressure, Pa}

where $u$ is the working gas speed, $V$ is volume, $A$ is flow cross-section area.

The net power loss of the Stirling engine due to pressure drop of the heat exchangers can be evaluated by:
\begin{equation}
	W_{pd} = \oint\underset{i = E,C}{\sum}(\Delta p_{i}\frac{dV_i}{d\theta})d\theta
\end{equation}

\item Effect of finite speed of piston and mechanical friction

Due to the finite speed of piston, the pressure on the piston surface is different from the pressure of expansion and compression spaces. It has been demonstrated that the pressure on the piston surface in the expansion process is less than the mean pressure in the expansion space. Similarly, the pressure on the piston surface in the compression process is greater than the mean pressure in the compression space. This means the output work is less than the theoretical value. Besides, The output work also reduces due to mechanical friction. The output work loss due to finite speed of piston and mechanical friction can be obtained as follows:~\cite{Babaelahi2015}
\begin{equation}
	W_{fs} = \oint p(\pm\frac{au_p}{c}\pm\frac{\Delta p_f}{p})dV
\end{equation}

where the sign ($+$) is used in the compression space, and the sign ($-$) is used in the expansion space. $p$ is the mean pressure in the compression/expansion space, $u_p$ is velocity of the piston, $c$ is the average speed of molecules and $\Delta p_f$ is the pressure loss due to mechanical friction. $\Delta p_f$, $a$ and $c$ can be expressed by:~\cite{Heywood1988}
\begin{equation}
	\Delta p_f = 0.97+0.009s_{se}
\end{equation}
\begin{equation}
	a = \sqrt{3k}
\end{equation}
\begin{equation}
	c = \sqrt{3RT}
\end{equation}

\item Energy losses due to internal conduction

The temperature differs from the heater and cooler, heat losses from heater to cooler exists due to internal conduction through the walls of regenerator.~\cite{Strauss2010} The internal conduction loss in a cycle can be expressed by follows:
\begin{equation}
	Q_{id} = \frac{k_rA_r}{L_rs_{se}}(T_{hw} - T_{cw})
\end{equation}

where, $k_r$, $A_r$ and $L_r$ denote the regenerator matrix conductivity, regenerator length, and regenerator conductive area respectively.
\nomenclature[S]{$r$}{Regenerator}

\item Energy losses due to shuttle conduction

The displacer shuttles between the expansion and compression space. It absorbs heat during the hot end of its stroke and releases it during the cold end of its stroke. This heat loss can be estimated as~\cite{Timoumi2008}:
\begin{equation}
	Q_{sc} = 0.4\frac{Z^2k_pD_p}{JL_ds_{se}}(T_{H} - T_{L})
\end{equation}

where, $Z$, $k_p$, $D_p$, $J$ and $L_d$ denote the displacer stroke, piston thermal conductivity, displacer diameter, gap between the displacer and the cylinder, and length of the displacer respectively.
\nomenclature{$Z$}{Displacer stroke, m}
\nomenclature{$J$}{Annular gap cylinder displacer, m}
%\nomenclature[S]{$p$}{Piston}

\end{enumerate}

So, in a Stirling engine, the total absorbed heat in a cycle
\begin{equation}
	Q = Q_{th} + Q_{id} + Q_{sc}
\end{equation}

the output work
\begin{equation}
	W = W_{th} - W_{pd} - W_{fs}
\end{equation}

Power of the Stirling engine
\begin{equation}
	P = Ws_{se}
	\label{Eq:P}
\end{equation}

Efficiency of the Stirling engine
\begin{equation}
	\eta = W/Q
	\label{Eq:eta}
\end{equation}


\subsubsection{Model validation}\label{sec:modelValidation}

Evaluation of the developed thermal model is performed by considering the GPU-3 Stirling engine as a case study. Design specifications of the GPU-3 Stirling engine are indicated in Table~\ref{tab:GPU3parameters}. The thermal efficiency and power of the proposed Stirling engine model are compared with previous thermal models and experimental data as shown in Table~\ref{tab:EfficiencyComparison} and Table~\ref{tab:PowerComparison}.

\begin{table*}[htbp]\footnotesize
	\caption{Design specifications of the GPU-3 Stirling engine~\cite{Babaelahi2015,Martini1983}}
	\begin{center}
	\begin{tabular}{ll}
		\toprule
		Parameter				&	Value\\
		\midrule
		Engine type					&	$\beta$\\
		Working gas			&	Helium\\
		Mass of the working gas	&	1.136\,g\\
		\emph{Heater}			&\\
		Number of tubes		&	40\\
		Tube external diameter	&	4.83$\times$10$^{-3}\,\mathrm{m}$\\
		Tube internal diameter	&	3.02$\times$10$^{-3}\,\mathrm{m}$\\
		Tube length (cylinder side)&	0.1164\,m\\
		Tube length (regenerator side)		&	0.1289\,m\\
		\emph{Cooler}			&\\
		Number of tubes		&	312\\
		Tube external diameter	&	1.59$\times$10$^{-3}\,\mathrm{m}$\\
		Tube internal diameter	&	1.09$\times$10$^{-3}\,\mathrm{m}$\\
		Average tube length		&	4.61$\times$10$^{-2}\,\mathrm{m}$\\
		\emph{Regenerator}		&\\
		Number of regenerator	&	8\\
		Regenerator internal diameter	&	2.26$\times$10$^{-2}\,\mathrm{m}$\\
		Regenerator length		&	2.26$\times$10$^{-2}\,\mathrm{m}$\\
		Diameter of regenerator tube	&	4$\times$10$^{-5}\,\mathrm{m}$\\
		Material				&	Stainless steel\\
		\emph{Volume}			&\\
		Swept Vol. (expansion/compression)	&	120.82/114.13\,$\mathrm{cm}^3$\\
		Clearance Vol. (expansion/compression)	&	30.52/28.68\,$\mathrm{cm}^3$\\
		Dead Vol. (heater/cooler/regenerator)	&	70.28/13.18/50.55\,$\mathrm{cm}^3$\\
		\bottomrule
	\end{tabular}
	\end{center}
	\label{tab:GPU3parameters}
\end{table*}

\begin{sidewaystable}[htbp]\footnotesize
  \renewcommand\arraystretch{0.75}
	\caption{Thermal efficiency of the models and experimental data (at $T_{hw}=$922$\,\mathrm{K}$ and $T_{cw}=$288$\,\mathrm{K}$)}
	\begin{center}
	\begin{tabular}{cccccccccccc}
		\toprule
		\multirow{5}{0.5in}{\tabincell{l}{Rotation\\speed\\(Hz)}}	&
    \multirow{5}{0.5in}{Mean\\ effective\\ pressure\\ (MPa)}	&	\multicolumn{3}{l}{\multirow{2}{1.4in}{The simple analysis (variable Pr~\cite{Urieli1984})}}	&	\multicolumn{3}{l}{\multirow{2}{1.4in}{The adiabatic analysis (simple II~\cite{Strauss2010})}}	&	\multicolumn{3}{l}{\multirow{2}{1.4in}{The proposed Stirling engine model}}	&	\multirow{2}{*}{\tabincell{l}{Experimental\\efficiency~\cite{Babaelahi2015}}}\\
    \\
    \\
		\cline{3-12}
		&&\multirow{3}{*}{\tabincell{c}{Value\\(\%)}}&	\multirow{3}{*}{\tabincell{c}{Error\\(\%)}}&\multirow{3}{*}{\tabincell{c}{Average\\error\\(\%)}}&\multirow{3}{*}{\tabincell{c}{Value\\(\%)}}&	\multirow{3}{*}{\tabincell{c}{Error\\(\%)}}&\multirow{3}{*}{\tabincell{c}{Average\\error\\(\%)}}&\multirow{3}{*}{\tabincell{c}{Value\\(\%)}}&	\multirow{3}{*}{\tabincell{c}{Error\\(\%)}}&\multirow{3}{*}{\tabincell{c}{Average\\error\\(\%)}}&\multirow{3}{*}{\tabincell{c}{Actual\\value\\(\%)}}\\
		\\
		\\
		\midrule
		16.67	&\multirow{6}{*}{2.76}	&38.72	&18.22	&\multirow{6}{*}{17.90}	&32.48	&11.98	&\multirow{6}{*}{12.85}	&28.16	&7.66	&\multirow{6}{*}{12.10}	&20.50\\
		25.00	&&36.16	&15.46	&&31.21	&10.51	&&27.75	&7.05	&&20.70\\
		33.33	&&33.79	&15.79	&&29.45	&11.45	&&27.43	&9.43	&&18.00\\
		41.67	&&31.48	&16.28	&&27.45	&12.25	&&27.17	&11.97	&&15.20\\
		50.00	&&29.12	&17.32	&&25.21	&13.41	&&26.94	&15.14	&&11.80\\
		58.33	&&29.74	&24.34	&&22.89	&17.49	&&26.74	&21.34	&&5.40\\
		\midrule
		25.00	&\multirow{5}{*}{4.14}	&35.65	&10.85	&\multirow{5}{*}{11.46}	&32.29	&7.49	&\multirow{5}{*}{8.28}	&27.29	&2.49	&\multirow{5}{*}{6.65}	&24.80\\
		33.33	&&33.52	&9.62	&&30.40	&6.50	&&26.94	&3.04	&&23.90\\
		41.67	&&31.48	&10.18	&&28.39	&7.09	&&26.65	&5.35	&&21.30\\
		50.00	&&29.45	&11.25	&&26.33	&8.13	&&26.39	&8.19	&&18.20\\
		58.33	&&27.40	&15.40	&&24.21	&12.21	&&26.17	&14.17	&&12.00\\
		\midrule
		41.67	&\multirow{3}{*}{5.52}	&31.20	&8.70	&\multirow{3}{*}{10.82}	&28.59	&6.09	&\multirow{3}{*}{8.11}	&26.24	&3.74	&\multirow{3}{*}{7.48}	&22.50\\
		50.00	&&29.33	&10.53	&&26.62	&7.82	&&25.97	&7.17	&&18.80\\
		58.33	&&27.44	&13.24	&&24.62	&10.42	&&25.73	&11.53	&&14.20\\
		\midrule
		50.00	&\multirow{2}{*}{6.90}	&29.07	&10.37	&\multirow{2}{*}{11.73}	&26.61	&7.91	&\multirow{2}{*}{9.19}	&25.62	&6.92	&\multirow{2}{*}{9.05}		&18.70\\
		58.33	&&27.29	&13.09	&&24.67	&10.47	&&25.37	&11.17	&&14.20\\
		\bottomrule
	\end{tabular}
	\end{center}
	\label{tab:EfficiencyComparison}
\end{sidewaystable}

\begin{sidewaystable}[htbp]\footnotesize
  \renewcommand\arraystretch{0.75}
	\caption{Output power of the models and experimental data (at $T_{hw}=$922$\,\mathrm{K}$ and $T_{cw}=$288$\,\mathrm{K}$)}
  \begin{center}
	\begin{tabular}{cccccccccccc}
		\toprule
		\multirow{5}{0.5in}{\tabincell{l}{Rotation\\speed\\(Hz)}}	&
    \multirow{5}{0.5in}{Mean\\ effective\\ pressure\\ (MPa)}	&	\multicolumn{3}{l}{\multirow{2}{1.4in}{The simple analysis (variable Pr~\cite{Urieli1984})}}	&	\multicolumn{3}{l}{\multirow{2}{1.4in}{The adiabatic analysis (simple II~\cite{Strauss2010})}}	&	\multicolumn{3}{l}{\multirow{2}{1.4in}{The proposed Stirling engine model}}	&	\multirow{2}{*}{\tabincell{l}{Experiment \\(kW)~\cite{Babaelahi2015}}}\\
    \\
    \\
		\cline{3-12}
		&&\multirow{3}{*}{\tabincell{c}{Value\\(kW)}}&	\multirow{3}{*}{\tabincell{c}{Error\\(\%)}}&\multirow{3}{*}{\tabincell{c}{Average\\error\\(\%)}}&\multirow{3}{*}{\tabincell{c}{Value\\(kW)}}&	\multirow{3}{*}{\tabincell{c}{Error\\(\%)}}&\multirow{3}{*}{\tabincell{c}{Average\\error\\(\%)}}&\multirow{3}{*}{\tabincell{c}{Value\\(kW)}}&	\multirow{3}{*}{\tabincell{c}{Error\\(\%)}}&\multirow{3}{*}{\tabincell{c}{Average\\error\\(\%)}}&\multirow{3}{*}{\tabincell{c}{Actual\\value\\(kW)}}\\
		\\
		\\
		\midrule
		16.67	&\multirow{6}{*}{2.76}	&1.796	&119.02	&\multirow{6}{*}{272.03}	&1.772	&116.10	&\multirow{6}{*}{254.71}	&0.861	&4.98	&\multirow{6}{*}{104.84}	&0.82\\
		25.00	&&2.555	&128.13	&&2.500	&123.21	&&1.253	&11.88	&&1.12\\
		33.33	&&3.215	&165.70	&&3.117	&157.60	&&1.632	&34.88	&&1.21\\
		41.67	&&3.769	&211.49	&&3.615	&198.76	&&2.001	&65.37	&&1.21\\
		50.00	&&4.195	&303.37	&&3.973	&282.08	&&2.362	&127.12	&&1.04\\
		58.33	&&4.505	&704.46	&&4.203	&650.54	&&2.715	&384.82	&&0.56\\
		\midrule
		25.00	&\multirow{5}{*}{4.14}	&3.844	&114.75	&\multirow{5}{*}{259.70}	&3.761	&110.11	&\multirow{5}{*}{158.41}	&1.818	&1.56	&\multirow{5}{*}{39.83}	&1.79\\
		33.33	&&4.856	&120.73	&&4.708	&114.00	&&2.362	&7.36	&&2.20\\
		41.67	&&5.734	&136.94	&&5.501	&127.31	&&2.890	&19.42	&&2.42\\
		50.00	&&6.462	&174.98	&&6.126	&160.68	&&3.405	&44.89	&&2.35\\
		58.33	&&7.030	&306.36	&&6.573	&279.94	&&3.908	&125.90	&&1.73\\
		\midrule
		41.67	&\multirow{3}{*}{5.52}	&7.645	&133.08	&\multirow{3}{*}{180.02}	&7.334	&123.60	&\multirow{3}{*}{164.91}	&3.742	&14.09	&\multirow{3}{*}{43.68}	&3.28\\
		50.00	&&8.655	&163.87	&&8.206	&150.18	&&4.401	&34.18	&&3.28\\
		58.33	&&9.470	&243.12	&&8.858	&220.94	&&5.045	&82.79	&&2.76\\
		\midrule
		50.00	&\multirow{2}{*}{6.90}	&10.788	&174.50	&\multirow{2}{*}{287.04}	&10.223	&160.13	&\multirow{2}{*}{263.63}	&5.362	&36.44	&\multirow{2}{*}{97.75}		&3.93\\
		58.33	&&11.840	&399.58	&&11.071	&367.13	&&6.140	&159.07	&&2.37\\
		\bottomrule
	\end{tabular}
	\end{center}
	\label{tab:PowerComparison}
\end{sidewaystable}

It can be found that the proposed model has much better agreement with the experimental results than previous thermal models at various rotation speeds and mean effective pressures. It is required to mention that in all thermal models both power $W$ and input heat $Q$ are determined by the thermal process of heat transfer between the wall and working gas. In the proposed model, $W$ and $Q$ are obtained from Equation~(\ref{eq:T_H}) and~(\ref{eq:T_L}). Therefore all the three parameters $W$, $Q$ and $\eta$ are determined by the thermal model and input parameters to the model. These input parameters includes heater, cooler, mean effective pressure, type of working gas and geometrical specification of the engine.

Table~\ref{tab:EfficiencyComparison} and~\ref{tab:PowerComparison} indicate that when mean effective pressure of the engine increases from 2.76$\,\mathrm{MPa}$ to 6.90$\,\mathrm{MPa}$, best performance (efficiency and power) prediction of the proposed model exists. When rotation speed increases from 16.67$\,\mathrm{Hz}$ to 58.33$\,\mathrm{Hz}$, error in prediction of performance of the proposed model increases. The proposed model may have the best performance prediction at a low rotation speed, with mean effective pressure between 4.14$\,\mathrm{MPa}$ and 5.52$\,\mathrm{MPa}$.

However, there is still some discrepancy between the the simulation results of proposed model and the experimental data. In the future researches, more accurate models of Stirling engine may be developed by considering other irreversibilities such as heat loss to the environment, gas spring hysteresis, and etc. It is worth pointing that there are more accurate Stirling engine models. For example, polytropic simulation models of Stirling engine show higher accuracy than our proposed model~\cite{Hosseinzade2015, Babaelahi2015}. However, the model needs more costly calculations and the polytropic indexes are engine-specific.

\subsubsection{Heat transfer between the engine and the fluids}

For a Stirling engine thermal process, the wall temperatures of the heater and cooler are considered to be uniform and constant. The heat transferred between the wall and the fluids after a contact area of $dA$ is
%with heating and cooling fluids, the heat exchange processes are considered to be isothermal processes.
%%For an isothermal process in Figure~\ref{fig:ConstTempHX}, transferred heat equals to fluid's enthalpy rise:
%For an isothermal process, transferred heat equals to fluid's enthalpy rise:
\begin{equation}
	(T_w-T)UdA = \dot{m}c_pdT
\end{equation}
\begin{equation}
	\frac{dT}{T-T_w}=-\frac{UdA}{\dot{m}c_p}
\end{equation}
\nomenclature{$c_p$}{Specific heat at constant pressure, J$\cdot$kg$^{-1}\cdot$K$^{-1}$}
\nomenclature{$T_w$}{Wall temperature, K}
\nomenclature{$A$}{Heat transfer area, m$^2$}

With $T(0)=T_i$, $T(A)=T_o$,
\begin{equation}
	\frac{T_o-T_w}{T_i-T_w}=\exp(-\frac{UA}{\dot{m}c_p})
\end{equation}

%\noindent \begin{figure}[htbp]
%\begin{center}
%	\includegraphics[width = 0.3\columnwidth]{fig/ConstTempHX}
%	\caption{Diagram of heat transfer to a constant temperature heat source}
%	\label{fig:ConstTempHX}
%\end{center}
%\end{figure}

%So
%
%\begin{equation}
%	\frac{dT}{dA}=-\frac{U}{\dot{m}c_p}(T-T_c)
%\end{equation}
%A simple Stirling engine model is used for the system. The cycle efficiency is given by \cite{Stine1985}
%
%\begin{equation}
%	\eta=\frac{T_{H}-T_{L}}{T_{H}+\text{\ensuremath{\dfrac{1-e}{k-1}}}\cdot\dfrac{T_{H}-T_{L}}{\ln\gamma}}\label{eq:eta_stirling}
%\end{equation}
%
%
%where \nomenclature{$e$}{Regeneration effectiveness of the Stirling engine}$e = (T_{R}-T_{L}) / (T_{H}-T_{L})$,\nomenclature{$T_R$}{Regenerator temperature, K}$T_{R}$ is the\emph{ }regenerator temperature, \nomenclature{$c_p$}{Heat capacity of Stirling engine working gas at constant pressure, J/(kg$\cdot$K)}\nomenclature{$c_v$}{Heat capacity of Stirling engine working gas at constant volume, J/(kg$\cdot$K)}$k=c_{p}/c_{v}$ for the working gas, $\gamma_{se}=V_{max}/V_{min}$ is the compression ratio.
%
%The heat transfer diagram is shown in Figure~\ref{fig:Heat-transfer-diagram}. Flow 1 is used for heating the hot chamber of Stirling engine, $T_{1i}$ is the inlet temperature, $T_{1o}$ is the outlet temperature. Flow 2 is used for cooling the cold chamber of Stirling engine, $T_{2i}$ is the inlet temperature, $T_{2o}$ is the outlet temperature. \nomenclature{$T_H$}{Highest temperature of expansion space, K}$T_{H}$ is the highest temperature of expansion space, \nomenclature{$T_L$}{Lowest temperature of compression space, K}$T_{L}$ is the lowest temperature of compression space.
%
%\noindent \begin{center}
%\begin{figure}[h]
%	\noindent \centering{}\includegraphics[width=0.4\columnwidth]{fig/StirilingHT}
%	\protect\caption{\label{fig:Heat-transfer-diagram}Heat transfer diagram of Stirling
%engine}
%\end{figure}
%
%\par\end{center}
%
%According to Equation (\ref{eq:Eq}),
%
%\begin{equation}
%	\dfrac{T_{1o}-T_{H}}{T_{1i}-T_{H}}=\exp(-\dfrac{U_{1}A_{1}}{\dot{m}_{1}c{}_{p1}})
%\end{equation}
%
%and
%
%\begin{equation}
%	\dfrac{T_{2o}-T_{L}}{T_{2i}-T_{L}}=\exp(-\dfrac{U_{2}A_{2}}{\dot{m}_{2}c_{p2}})
%\end{equation}
%
%So known $T_{1o},T_{1i},U_{1},A_{1},\dot{m}_{1},c_{p1},T_{2o},T_{2i},U_{2},A_{2},\dot{m}_{2},c_{p2}$, $T_{H}$ and $T_{L}$ can be calculated, and then $\eta$ can be obtained using Equation (\ref{eq:eta_stirling}).
%\nomenclature{$A$}{Area, m$^2$}

For a Stirling engine, $T_{hw}$ or $T_{cw}$ can be used to substitute $T_w$ to get the relationships between $T_{i,h}$, $T_{o,h}$ and $T_{hw}$, or $T_{i,c}$, $T_{o,c}$ and $T_{cw}$ respectively.
\nomenclature[S]{$h$}{Heating fluid; homogeneous solution}
\nomenclature[S]{$c$}{Cooling fluid; counterflow}
\begin{equation}
	\frac{T_{o,h}-T_{hw}}{T_{i,h}-T_{hw}}=\exp(-\frac{U_hA_h}{\dot{m}_hc_{p,h}})
	\label{Eq:T_h}
\end{equation}
\begin{equation}
	\frac{T_{o,c}-T_{cw}}{T_{i,c}-T_{cw}}=\exp(-\frac{U_cA_c}{\dot{m}_cc_{p,c}})
	\label{Eq:T_c}
\end{equation}

Heat transferred from heating fluid to Stirling engine in a cycle
\begin{equation}
	\dot{m}_hc_{p,h}(T_{i,h}-T_{o,h})/s_{se} = Q
	\label{Eq:q_h}
\end{equation}

Heat transferred from Stirling engine to cooling fluid in a cycle
\begin{equation}
	\dot{m}_cc_{p,c}(T_{o,c}-T_{i,c})/s_{se} = Q - W
	\label{Eq:q_c}
\end{equation}

%For a Stirling engine given $\dot{m}_h$, $\dot{m}_c$ and $s_{se}$, known 2 of the 6 parameters ($T_{i,h}$, $T_{o,h}$, $T_{i,c}$, $T_{o,c}$, $T_H$ and $T_L$), the rest 4 can be obtained by solving
%%Equation~\ref{Eq:T_h},~\ref{Eq:T_c},~\ref{Eq:q_h} and~\ref{Eq:q_c}
%Equation~\ref{Eq:T_h}-\ref{Eq:q_c}
%. Then $\eta$ and $P$ can be obtained by Equation~\ref{Eq:eta} and~\ref{Eq:P}. This means the performance of a given Stirling engine can be inquired by the input/output parameters of heating/cooling fluids.

\subsection{Rankine power generation system}
%The power generating system includes the turbine (steam turbine or ORC turbine) and generator.

%The Rankine power generation system consists of turbine, condenser, deaerator, generator and pumps. 
Based on different working fluids, there are two different kinds of Rankine power generation systems, steam Rankine power generation system and organic Rankine power generation.
\subsubsection{Steam Rankine cycle}
  
  For steam Rankine cycle, a deaerator is used to remove the oxygen and other non-condensable gases in the feedwater of steam generating system. Dissolved oxygen in feedwater will cause serious corrosion damage in steam generating system by forming oxides (rust) of the metal pipes. Dissolved carbon dioxide combines with water to form carbonic acid will cause further corrosion. The accumulation of the non-condensable gases will increase the heat transfer resistance, which is harmful for the heat exchangers. The extraction of the steam turbine provides heat for the deaerator.
  
  Figure~\ref{fig:Ts_Water} shows the $T$-$s$ diagram of the water circuit in the cascade system in Figure~\ref{fig:PES}. Process $2a$-$2c$-$2b$ shows the heat process in the steam turbine (see Figure~\ref{fig:SteamTurbine_hs}). State point $2b$ and $i,2b$ have the same pressure, state point $2c$ and $i,2c$ have the same pressure. To simplify the inner process $2a$-$2c$-$2b$ of the turbine, same isentropic efficiency of steam turbine with different loads and in different stages is assumed, which means  
  \begin{equation}
      \eta_{i,tb} =(h_{2a}-h_{2b})/(h_{2a}-h_{i,2b}) = (h_{2a}-h_{2c})/(h_{2a}-h_{i,2c})
\end{equation}
where $h_{i,2b}$ is determined by $s_{2a}$ and $p_c$; $h_{i,2c}$ is determined by $s_{2a}$ and $p_e$.

\noindent \begin{figure}[htbp]
\centering
	\begin{subfigure}[b]{0.6\columnwidth}
	\includegraphics[width = \columnwidth]{fig/T-s_Water.pdf}
	\caption{$T$-$s$ diagram of the water circuit}\label{fig:Ts_Water}
	\end{subfigure}
	~
\begin{subfigure}[b]{0.3\columnwidth}
	\includegraphics[width = \columnwidth]{fig/SteamTurbine_hs.pdf}
	\caption{$h$-$s$ diagram of the process $2a$-$2c$-$2b$}\label{fig:SteamTurbine_hs}
	\end{subfigure}
	
	\caption{$T$-$s$ diagram of the water circuit and $h$-$s$ diagram of the process $2a$-$2b$}\label{fig:SteamTurbine_hs_p}
\end{figure}

    The output power of the steam turbine
    \begin{equation}
  P_{tb}=\left(1-y\right)\dot{m}_{2}\left(h_{2a}-h_{2b}\right)+y\dot{m}_{2}\left(h_{2a}-h_{2c}\right)
  \end{equation}
  \nomenclature{$y$}{Extraction rate of steam turbine}
  Process $2b$-$2d$ shows the heat process in the condenser. The outlet water in the condenser is saturated water. The outlet temperature $T_{2d}$ and outlet enthalpy $h_{2d}$ are determined by the exhaust pressure of the turbine $p_c$.
  The released heat of the condenser
  \begin{equation}
      Q_{cd} = (1-y)\dot{m}_2 (h_{2b} - h_{2d})
\end{equation}
\nomenclature[S]{$cd$}{Condenser}
  State points $2c$, $2f$ and $2g$ have the same pressure ($p_e$, 1$\,\mathrm{MPa}$). The water at the outlet of the deaerator is saturated fluid, its enthalpy is determined.
  \begin{equation}
  y h_{2c} + (1-y) h_{2f} = h_{2g}
\end{equation}
\nomenclature{$p_e$}{Extraction pressure of the steam turbine, Pa}  
  The total power of the pumps 
\begin{equation}
	P_{pu}=\left(1-y\right)\dot{m}_{2}\left(h_{2e}-h_{2d}\right)+\dot{m}_{2}\left(h_{2h}-h_{2g}\right)
\end{equation}
    \nomenclature[S]{$pu$}{Pump}    
where $h_{2e}$ can be obtained from $\eta_{pu} = (h_{i,2e}-h_{2d})/(h_{2e}-h_{2d})$, $h_{2h}$ can be obtained from $\eta_{pu} = (h_{i,2h}-h_{2g})/(h_{2h}-h_{2g})$. $h_{i,2e}$ is determined by $s_{2d}$ and $p_e$, $h_{i,2h}$ is determined by $s_{2g}$ and $p_s$.
    
The outlet water of the deaerator is saturated water ($x = 0$), so the outlet temperature $T_{2g}$ and outlet enthalpy $h_{2g}$ of the heated fluid is determined by pressure $p_{2g}$. For the deaerator, the outlet pressure equals to any of the inlet pressure.
\begin{equation}
  p_{2g} = p_{2c}
\end{equation}    
Heat injected in the water circuit
\begin{equation}
	    Q_2=\left(1-y\right)\dot{m}_{2}\left(h_{2f}-h_{2e}\right)+\dot{m}_{2}\left(h_{2a}-h_{2h}\right)
    \end{equation}
The efficiency of Rankine cycle can be expressed as
\begin{equation}
	\eta_{rk}=(P_{tb}-P_{pu}/\eta_{ge})/Q_{2}
\end{equation}

\subsubsection{Organic Rankine cycle}
  
  Compared with steam Rankine cycle, ORC has the following features:
  \begin{enumerate}[label=(\arabic*)]
  \item Organic fluid has lower boiling point, and higher evaporation pressure. It is suitable for the recovery of low temperature waste heat. Besides, it has small density and specific heat capacity, the required size of turbine, pipes and heat transfer areas are small, which is beneficial for cost saving.
  \item The exhaust fluid of the turbine is dry. So without overheat, the saturated gas can be used as the main gas for the turbine. The corrosion situation caused by the impact of the droplets to the high-speed rotating blades will not happen with ORC.
  \item Organic fluid has lower sound speed than vapor, the turbine can achieve favorable aerodynamic performance with lower wheel speed. 
  \item Organic fluid has higher condensing pressure than water. It can condense under the pressure higher than the atmosphere. The system pressure can be maintained above the atmosphere pressure to prevent air leak into the system. This means a deaerator is no more necessary.
  \item Organic fluid has low freezing point, no anti-freezing treatment is required even in the cold area.
\end{enumerate}

The shapes of curves in the $T$-$s$ diagram of different fluids are different. According to the saturated vapor curve $dT/ds$ in the $T$-$s$ diagram, the working fluid can be divided into three types: $dT / ds > 0$ means dry fluid (moisture does not form when high-pressure saturated vapor expanded reversibly from a high pressure) , most of the organic fluid are dry fluids; $dT / ds < 0$ means wet fluid (moisture forms when high-pressure saturated vapor expanded reversibly from a high pressure), such as water; $dT/ds \rightarrow \pm\infty$ means isentropic fluid, such as R134a. For the high temperature high pressure dry fluid and isentropic fluid, since there is no droplets after work in the expansion turbine, no superheater is required. On the other hand, since the purpose of the ORC focuses on the recovery of low grade heat power, a superheated approach like the traditional Rankine cycle is not appropriate. 

Figure~\ref{fig:$T$-$s$_2systems} shows the $T$-$s$ diagram of steam Rankine cycle and ORC cycle. Figure~\ref{fig:ORCsystem2} shows the schematic diagram of the ORC system. For a dry fluid, the cycle can be improved by the use of a regenerator: since the fluid has not reached the two-phase state at the end of the expansion, its temperature at this point is higher than the condensing temperature. This higher temperature fluid can be used to preheat the liquid before it enters the evaporator.
A counter-current heat exchanger is thus installed between the expander outlet and the evaporator inlet. The power required from the heat source is therefore reduced and the efficiency is increased.

\noindent \begin{figure}[htbp]
\begin{center}
	\includegraphics[width = 0.8\columnwidth]{fig/Ts.pdf}
	\caption{$T$-$s$ diagram of water and a typical organic fluid in Rankine cycles}
	\label{fig:$T$-$s$_2systems}
\end{center}
\end{figure}

\noindent \begin{figure}[htbp]
\begin{center}
	\includegraphics[width = 0.4\columnwidth]{fig/ORCsystem2.pdf}
	\caption{The schematic diagram of an ORC system with regenerator}
	\label{fig:ORCsystem2}
\end{center}
\end{figure}

The isentropic efficiency of the turbine
\begin{equation}
  \eta_{i,tb} = (h_{4a}-h_{4b})/(h_{4a}-h_{i,4b})
\end{equation}

where $h_{i,4b}$ is determined by $s_{4a}$ and $p_c$.

The output power of the turbine
\begin{equation}
  P_{tb}=\dot{m}_{4}(h_{4a}-h_{4b})
\end{equation}

Process $4c$-$4d$ shows the heat process in the condenser. The outlet fluid of the condenser is saturated liquid. The outlet temperature $T_{4d}$ and outlet enthalpy $h_{4d}$ are determined by the exhaust pressure of the turbine $p_c$.

For the regenerator,
\begin{equation}
  h_{4b} - h_{4c} = h_{4f} - h_{4e}
\end{equation}

The released heat of the condenser
\begin{equation}
  Q_{cd} = \dot{m}_4 (h_{4c} - h_{4d})
\end{equation}

The power of the pump
\begin{equation}
P_{pu}=\dot{m}_{4}(h_{4e}-h_{4d})
\end{equation}
    
where $h_{4e}$ can be obtained from $\eta_{pu} = (h_{i,4e}-h_{4d})/(h_{4e}-h_{4d})$. $h_{i,4e}$ is determined by $s_{4d}$ and $p_s$.
    
Heat injected in the circuit
\begin{equation}
    Q_4=\dot{m}_4(h_{4a}-h_{4f})
\end{equation}

The efficiency of Rankine cycle can be expressed as
\begin{equation}
	\eta_{rk}=\dfrac{P_{tb}-P_{pu}/\eta_{ge}}{\dot{m}_4(h_{4a}-h_{4f})}
\end{equation}

%\noindent \begin{figure}[htbp]
%\begin{center}
%	\includegraphics[width = 0.6\columnwidth]{fig/ORCsystem1.pdf}
%	\caption{The schematic diagram of an ORC system without regenerator}
%	\label{fig:ORCsystem1}
%\end{center}
%\end{figure}

%  The stream exiting the turbine is passed through a recuperator to heat the feed working fluid.


\subsubsection{Generator}
The generator is relatively independent of the cascade system and its efficiency is assumed to be a constant value, 0.975.

%\subsubsection{Thermal storage system}

%\section{Steam generating system}
%\section{Steam extraction and regeneration system}
\section{Stirling engine array modeling}

\begin{figure}[htbp]
\begin{center}
	\includegraphics[width = 0.6\columnwidth]{fig/stirlingEngineArray.pdf}
	\caption{Layout of Stirling engines}
	\label{fig:Layout of Stirling engines}
\end{center}
\end{figure}
Stirling engine array is used in the cascade system, Figure~\ref{fig:Layout of Stirling engines} shows the layout of a Stirling engine array. Each Stirling engine in the Stirling engine array has the identical parameters: $U_{se,1}=30\,\mathrm{W/(m^2\cdot{}K)}$, $U_{se,2}=150\,\mathrm{W/(m^2\cdot{}K)}$, $A_{se,1}=6\,\mathrm{m^2}$, $A_{se,2}=6\,\mathrm{m^2}$, $k_{se}=1.4$, $\gamma_{se}=3.375$, $n_g=7.84\times10^{-2}\,\mathrm{mol}$, $s_{se}=10\,\mathrm{s^{-1}}$.

Depending on the direction of heating and cooling flows, there are two possible flow types: parallel flow and counterflow. 
Figure~\ref{fig:twoFlowTypes} and 
Figure~\ref{fig:CounterFlow} show the heat transfer diagrams of the two flow types.
\nomenclature{$n_1$}{Number of columns of the Stirling engine array} $n_1$ is chosen to be 10 and can be optimized later.

\noindent \begin{figure}[htbp]
\centering
	\begin{subfigure}[b]{0.45\columnwidth}
	\includegraphics[width = \columnwidth]{fig/HeatTransfer_Parallel.pdf}
	\caption{Parallel flow}\label{fig:ParallelFlow}
	\end{subfigure}
	~
\begin{subfigure}[b]{0.45\columnwidth}
	\includegraphics[width = \columnwidth]{fig/HeatTransfer_Counter.pdf}
	\caption{Counterflow}\label{fig:CounterFlow}
	\end{subfigure}
	\caption{Heat transfer diagrams of parallel flow and counterflow}
	\label{fig:twoFlowTypes}
\end{figure}

In Figure~\ref{fig:Layout of Stirling engines}, $T_{1,i,1}=T_{1,i},\dot{m}_{1,r}=\dot{m}_{1}/n_{2}$. For $x$ from $1$ to $n_1-1$, where $x$ is the column number of Stirling engines, $T_{1,i,x+1}=T_{1,o,x},T_{2,i,x+1}=T_{2,o,x}$.
\nomenclature{$n_1$}{Number of columns of the Stirling engine array}
%\nomenclature{$\dot{m}_{1}$}{Total mass flow rate of air, kg/s}

Assume that the positive flow direction is to the right, for parallel flow, $T_{2,i,1}=T_{2,i}$, $\dot{m}_{2,r}=\dot{m}_{2}/n_{2}$; for counterflow, $T_{2,o,n_1}=T_{2,i}$, $\dot{m}_{2,r}=-\dot{m}_{2}/n_{2}$.
\nomenclature{$n_2$}{Number of row s of the Stirling engine array}
\nomenclature{$\dot{m}$}{Mass flow rate, kg$\cdot$s$^{-1}$}

%\begin{equation}
%	T_{2,i,1}=T_{2,i}\label{eq:T_2_i_1}
%\end{equation}
%\begin{equation}
%	\dot{m}_{2,r}=\dot{m}_{2}/n_{2}
%\end{equation}
%\nomenclature{$\dot{m}_{2,r}$}{Mass flow rate of water in each row of Stirling engine array, kg/s}
%\nomenclature{$\dot{m}_{2}$}{Total mass flow rate of water, kg/s}

%for counterflow,
%
%\begin{equation}
%	T_{2,o,n_1}=T_{2,i}\label{eq:T_2_o_n1}
%\end{equation}
%\begin{equation}
%	\dot{m}_{2,r}=-\dot{m}_{2}/n_{2}
%\end{equation}

Assume linear temperature profile across the regenerator, the mean effective temperature $T_{R,x}=\dfrac{T_{H,x}-T_{L,x}}{\ln(T_{H,x}/T_{L,x})}$,~\cite{Der2007,Cavazzuti2012} and the symmetrical regenerator behaviour assumption $e_{x}=\dfrac{T_{R,x}-T_{L,x}}{T_{H,x}-T_{L,x}}$.~\cite{Formosa2010,Juhasz2010} 

For a Stirling engine in column $x$, $x$ from $1$ to $n_1$, according to Equation~(\ref{eq:T_H}) and Equation~(\ref{eq:T_L}),
\nomenclature[S]{$x$}{Stirling engine in column $x$}
\begin{equation}
	T_{hw,x}=T_{1,i,x}-\dfrac{T_{1,i,x}-T_{1,o,x}}{1-\exp(-\dfrac{U_{se,1}A_{se,1}}{\dot{m}_{1,r}c_{p,1,x}})}\label{eq:T_H_x}
\end{equation}


\begin{equation}
	T_{cw,x}=T_{2,i,x}-\dfrac{T_{2,i,x}-T_{2,o,x}}{1-\exp(-\dfrac{U_{se,2}A_{se,2}}{\dot{m}_{2,r}c_{p,2,x}})}\label{eq:T_L_x}
\end{equation}

The power of each Stirling engine in column $x$ can be written as 
\begin{equation}
  P_{se,x} = W_{th,x}-W_{pd,x}-W_{fs,x}
\end{equation}

The efficiency of each Stirling engine in column $x$ can be written as 
\begin{equation}
  \eta_{se,x} = \dfrac{W_{th,x}-W_{pd,x}-W_{fs,x}}{Q_{th,x}+Q_{id,x}+Q_{sc,x}}
\end{equation}

%$\eta_{se,x}=\dfrac{T_{H,x}-T_{L,x}}{T_{H,x}+\dfrac{1-e_{x}}{k-1}\cdot\dfrac{T_{H,x}-T_{L,x}}{\ln\gamma_{se}}}\label{eq:eta_striling_x}$, where $e_{x}=\dfrac{T_{R,x}-T_{L,x}}{T_{H,x}-T_{L,x}}$~\cite{Stine1985,Juhasz2010} and $T_{R,x}=\dfrac{T_{H,x}-T_{L,x}}{\ln(T_{H,x}/T_{L,x})}$~\cite{Der2007,Cavazzuti2012}.

%\begin{equation}
%	\eta_{se,x}=\dfrac{T_{H,x}-T_{L,x}}{T_{H,x}+\dfrac{1-e_{x}}{k-1}\cdot\dfrac{T_{H,x}-T_{L,x}}{\ln\gamma_{se}}}\label{eq:eta_striling_x}
%\end{equation}

For energy balance,
\begin{equation}
	\dot{m}_{1,r}(h_{1,i,x}-h_{1,o,x})(1-\eta_{se,x})=\dot{m}_{2,r}(h_{2,o,x}-h_{2,i,x})
\end{equation}

%And in each Stirling cycle, the heat absorbed by the working gas is
%\begin{equation}
%\begin{split}
%	n_gR(T_{H,x}\ln\gamma_{se}+\dfrac{1-e_{x}}{k-1}(T_{H,x}-T_{L,x}))=\dot{m}_{1,r}(h_{1,i,x}-h_{1,o,x})/s_{se}
%\end{split}
%\end{equation}

Using equations in Section~\ref{sec:StirlingEngineModel} and the energy balance equations, key parameters of the Stirling engine array can be obtained. 

The efficiency of the Stirling engine array 
\begin{equation}
  \eta_{sea}=1-\dfrac{\dot{m}_{2}(h_{2,o,n_1}-h_{2,i,1})}{\dot{m}_{1}(h_{1,i,1}-h_{1,o,n_1})}
\end{equation}

The output power of each Stirling engine in column $x$
\begin{equation}
  P_{se,x}=\dot{m}_{1,r}(h_{1,i,x}-h_{1,o,x})\eta_{se,x}
\end{equation}

The total output power of the Stirling engine array
\begin{equation}
  P_{sea}=\eta_{sea}\dot{m}_{1}(h_{1,i,1}-h_{1,o,n_1})
\end{equation}

\section{Steam generating system modeling}
The steam generating system can be divided into preheater, evaporator and superheater, they are collectively referred to as PES. They are all heat exchangers. It is assumed that, in these heat exchangers, the pressure of the fluid does not change significantly. It can be assumed that the water pressure in the steam generating system equals to the pressure of the inlet pressure of the turbine. Besides, these heat exchangers do not exchange heat with the environment.
To clearly understand the modeling process of these heat exchangers, an example of steam generating system as shown in Figure~\ref{fig:PES} is used for explanation. Figure~\ref{fig:PES_TQ} shows the $T$-$Q$ diagram of the heat transfer process. State points of different fluids are marked on the sketch. The number indicates the type of the fluid, the letter indicates the state point of the fluid. A state point with solid circle indicates saturated liquid state ($x = 0$), and with dotted circle indicates saturated gas state ($x = 1$).
\nomenclature{$x$}{Dryness fraction}

%State points of different fluids are marked on the sketch. The number indicates the type of the fluid, the letter indicates the state point of the fluid. State points with solid circle indicate saturated liquid states ($x = 0$\nomenclature{$x$}{Dryness fraction}), and with dotted circle indicates saturated gas states ($x = 1$).

\noindent \begin{figure}[!ht]
\begin{center}
	\includegraphics[width = 0.8\columnwidth]{fig/PES}
	\caption{An example of steam generating system in a cascade system}
	\label{fig:PES}
\end{center}
\end{figure}

\noindent \begin{figure}[htbp]
\begin{center}
	\includegraphics[width = 0.5\columnwidth]{fig/PES_TQ}
	\caption{The steam generating process}
	\label{fig:PES_TQ}
\end{center}
\end{figure}

The modeling process of PES is the process of solving the unknown states of the state points. Notice that, the pressure of the fluids keeps constant in the heat transfer process. For an unsaturated state, known the temperature or enthalpy, the state is determined. This means, the temperature can be obtained from the enthalpy, and vice versa. For a saturated state, known the dryness ($x$) of the fluid, the state is determined.

For a typical PES modeling process as shown in Figure~\ref{fig:PES}, $\dot{m}_2$, state $2h$ and state $2k$ are determined by the parameters of the turbine. State $3a$ is determined by the design parameters. State $2i$ and state $2j$ are determined by their dryness values. 

\begin{enumerate}[label=(\arabic*)]
  \item \emph{Preheater}
  
  The outlet of the heated fluid is saturated liquid ($x = 0$), so the outlet temperature $T_{2i}$ and outlet enthalpy $h_{2i}$ of the heated fluid are determined by the main pressure of the turbine, $p_s$.
  \begin{equation}
  \dot{m}_3 (h_{3c}-h_{3d})=\dot{m}_2 (h_{2i} - h_{2h})
  \label{eq:preheater}
\end{equation}

  \item \emph{Evaporator}
  
  The outlet of the heated fluid is saturated gas ($x = 1$), so the outlet temperature $T_{2j}$ and outlet enthalpy $h_{2j}$ of the heated fluid are determined by the main pressure of the turbine, $p_s$.
  \begin{equation}
  \dot{m}_3 (h_{3b}-h_{3c})=\dot{m}_2 (h_{2j} - h_{2i})
  \label{eq:evaporator}
\end{equation}
	It has to be mentioned that, state $3c$ is determined by $T_{3c}$, which equals to $T_{2i} + \Delta T_{min}$. ($T_{3c} = T_{2i} + \Delta T_{min}$)
  
  \item \emph{Superheater}
  
  For the energy balance,
  \begin{equation}
  \dot{m}_3 (h_{3a}-h_{3b})=\dot{m}_2 (h_{2k} - h_{2j})
  \label{eq:superheater}
\end{equation}
	  
\end{enumerate}

By solving the equations~(\ref{eq:preheater}) to~(\ref{eq:superheater}), $\dot{m}_3$, state $3b$ and $3d$ can be obtained.

\section{System modeling}

%\subsection{Stream}
Different components are connected to form a system by their interfaces (inlets and outlets). These interfaces are interacted with each other by "streams". For example, the steam turbine in Figure~\ref{fig:PES} is connected with the deaerator by a steam stream. This steam stream has its own properties such as fluid type, mass flow rate, temperature, pressure and so on.
"Steams" are defined as objects in the modeling language -- MATLAB. Appendix~\ref{cha:MATLAB_SOURCECODE} shows the source code of the definition of the class -- \textbf{Stream}.

Some properties, \textbf{T}, \textbf{q\_m} and \textbf{p}, of \textbf{Stream} are also objects. They belong to the classes \textbf{Temperature}, \textbf{Massflow} and \textbf{Pressure} separately.

Given the inherent properties of a \textbf{Stream}, its dependent properties, mass specific enthalpy (\textbf{h}), mass specific entropy (\textbf{s}) and pressure (\textbf{p}), can be obtained.

If the stream is a single phase stream, its dryness does not exist. Its dependent properties ($h$, $s$, $c_p$) can be obtained from its temperature ($T$) and pressure ($p$) by calling the open source MATALB wrapper CoolProp. If the stream is a two-phase stream, $0 \leqslant x \leqslant 1$. Its dependent properties ($h$, $s$, $c_p$) can be obtained from its pressure ($p$) and dryness ($x$). The reason of choosing pressure ($p$) instead of temperature ($T$) as the input value is that it is easier to be determined.

A \textbf{stream} can be used to record a state point since it contains all the information for a state point. Streams are defined in a system for component connection and system calculation. Different components are connected by streams to form a system. The Streams are passed as parameters to the components, completing the calculation of the methods in the components.

%\subsection{System connection}
Components are connected each other by streams. Their inlets and outlets are used as interfaces for connection. 
Two interfaces are connected together by being assigned the same stream.

%\subsection{System initialization}
Systems are initialized by given parameters (design parameters). These parameters are assigned to corresponding properties of the streams and thus affect the state of the related components.

%\subsection{System calculation}
For system calculation, it has to be mentioned that, some parameters of a component are related with other components. 
In such situations, guess values are used for the calculation methods in the components.
The guess values are set to be the properties of some streams. Each of these streams is assigned to two components (evaporator and superheater). These streams are assigned to corresponding components to accomplish the calculation methods in the components. These calculation methods will return solutions for the stream parameters. Then the parameters will be compared with the guess values for verification. If the differences between guess values and the calculated parameters are within permissible error, the guess values are accepted; otherwise, the guess values will be iteratively readjusted according to the Runge-Kutta method until accepted.

For example, the mass flow rate of oil of the evaporator ($\dot{m}_3$) is related with the superheater in a system as described in Figure~\ref{fig:CascadeSystem1}.
A guess value of $\dot{m}_3$, $\dot{m}_{3,g}$, is required to determine it. $\dot{m}_{3,g}$ is assigned to the evaporator oil stream. This stream is assigned to both evaporator and superheater. In \textbf{evaporator}, the method \textbf{get\_T\_3b} will change the temperature of the stream ($T_{3b}$) from the default value. 
In \textbf{superheater}, the method \textbf{get\_q\_m\_3} will return a solution of $\dot{m}_3$, $\dot{m}_{3,s}$, for verification. If $\left|\dot{m}_{3,g} - \dot{m}_{3,s}\right|$ is less than permissible error ($10^{-4}$), then $\dot{m}_{3,g}$ is accepted as the value of $\dot{m}_{3}$; otherwise, $\dot{m}_{3,g}$ will be iteratively readjusted according to the Runge-Kutta method until $\left|\dot{m}_{3,g} - \dot{m}_{3,s}\right| < 10^{-4}$.

\section{Conclusion}

This chapter presents the modeling method of the cascade system and introduces the modeling of some key components and subsystems in detail. The component models are developed in MATLAB using object-oriented method. Bottom-up design method is applied for system development. Models of the components of a system are developed first according to their mechanism characteristics, and the system model is established by these component models. A MATLAB class \textbf{Stream} created for component connection is used as an example to introduce the system modeling process. The components' inlets and outlets are used as interfaces for connection. 
Two interfaces are connected together by being assigned the same stream.
The calculation process related with different components is also briefly introduced in this chapter.

Due to the encapsulation, composition and polymorphism of the object-oriented language, the system model has some advantages such as easy to establish, convenient to replace a component and clearly check the performance of specific components.

The key component models in the cascade system can be validated experimentally or be compared with the classic models. The validation of Stirling engine model shows that the proposed model has much better agreement with the experimental results than previous classic thermal models at various rotation speeds and mean effective pressures.